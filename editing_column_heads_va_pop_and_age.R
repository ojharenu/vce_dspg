#CHANGING THE COLUMN NAMES OF THE EXCEL SHEET TO MAKE THEM MORE READABLE

library(dplyr)
library(tidycensus)
library(tidyverse)

Virginia_Pop_and_Age_2020_to_2023 <- Virginia_Pop_and_Age_2020_to_2023 %>%
  rename("Summarized Level Code" = "SUMLEV",
         "FIPS Code" = "STATE",
         "State" = "STNAME",
         "County" = "CTYNAME",
         "Population (estimated)" = "POPESTIMATE",
         "Estimated Male Population" = "POPEST_MALE",
         "Estimated Female Population" = "POPEST_FEM",
         "Total Population Under 5 y/o" = "UNDER5_TOT",
         "Male Population under 5 y/o" = "UNDER5_MALE",
         "Female Population under 5 y/0" = "UNDER5_FEM",
         "Total Population Aged 5-13" = "AGE513_TOT",
         "Male Population Aged 5-13" = "AGE513_MALE",
         "Female Population Aged 5-13" = "AGE513_FEM",
         "Total Population Aged 14-17" = "AGE1417_TOT",
         "Male Population Aged 14-17" = "AGE1417_MALE",
         "Female Population Aged 14-17" = "AGE1417_FEM",
         "Total Population Aged 18-24" = "AGE1824_TOT",
         "Male Population Aged 18-24" = "AGE1824_MALE",
         "Female Population Aged 18-24" = "AGE1824_FEM",
         "Total Population Aged 16+" = "AGE16PLUS_TOT",
         "Male Population Aged 16+" = "AGE16PLUS_MALE",
         "Female Population Aged 16+" = "AGE16PLUS_FEM",
         "Total Population Aged 18+" = "AGE18PLUS_TOT",
         "Male Population Aged 18+" = "AGE18PLUS_MALE",
         "Female Population Aged 18+" = "AGE18PLUS_FEM",
         "Total Population Aged 15-44" = "AGE1544_TOT",
         "Male Population Aged 15-44" = "AGE1544_MALE",
         "Female Population Aged 15-44" = "AGE1544_FEM",
         "Total Population Aged 25-44" = "AGE2544_TOT",
         "Male Population Aged 25-44" = "AGE2544_MALE",
         "Female Population Aged 25-44" = "AGE2544_FEM",
         "Total Population Aged 45-64" = "AGE4564_TOT",
         "Male Population Aged 45-64" = "AGE4564_MALE",
         "Female Population Aged 45-64" = "AGE4564_FEM",
         "Total Population Aged 65+" = "AGE65PLUS_TOT",
         "Male Population Aged 65+" = "AGE65PLUS_MALE",
         "Female Population Aged 65+" = "AGE65PLUS_FEM",
         "Total Population Aged 0-4" = "AGE04_TOT",
         "Male Population Aged 0-4" = "AGE04_MALE",
         "Female Population Aged 0-4" = "AGE04_FEM",
         "Total Population Aged 5-9" = "AGE59_TOT",
         "Male Population Aged 5-9" = "AGE59_MALE",
         "Female Population Aged 5-9" = "AGE59_FEM",
         "Total Population Aged 10-14" = "AGE1014_TOT",
         "Male Population Aged 10-14" = "AGE1014_MALE",
         "Female Population Aged 10-14" = "AGE1014_FEM",
         "Total Population Aged 15-19" = "AGE1519_TOT",
         "Male Population Aged 15-19" = "AGE1519_MALE",
         "Female Population Aged 15-19" = "AGE1519_FEM",
         "Total Population Aged 20-24" = "AGE2024_TOT",
         "Male Population Aged 20-24" = "AGE2024_MALE",
         "Female Population Aged 20-24" = "AGE2024_FEM",
         "Total Population Aged 25-29" = "AGE2529_TOT",
         "Male Population Aged 25-29" = "AGE2529_MALE",
         "Female Population Aged 25-29" = "AGE2529_FEM",
         "Total Population Aged 30-34" = "AGE3034_TOT",
         "Male Population Aged 30-34" = "AGE3034_MALE",
         "Female Population Aged 30-34"= "AGE3034_FEM",
         "Total Population Aged 35-39" = "AGE2529_TOT",
         "Male Population Aged 35-39" = "AGE3539_MALE",
         "Female Population Aged 35-39" = "AGE3539_FEM",
         "Total Population Aged 40-44" = "AGE4044_TOT",
         "Male Population Aged 40-44" = "AGE4044_MALE",
         "Female Population Aged 40-44" = "AGE4044_FEM",
         "Total Population Aged 45-49" = "AGE4549_TOT",
         "Male Population Aged 45-49" = "AGE4549_MALE",
         "Female Population Aged 45-49" = "AGE4549_FEM",
         "Total Population Aged 50-54" = "AGE5054_TOT",
         "Male Population Aged 50-54" = "AGE5054_MALE",
         "Female Population Aged 50-54" = "AGE5054_FEM",
         "Total Population Aged 55-59" = "AGE5559_TOT",
         "Male Population Aged 55-59" = "AGE5559_MALE",
         "Female Population Aged 55-59" = "AGE5559_FEM",
         "Total Population Aged 60-64" = "AGE6064_TOT",
         "Male Population Aged 60-64" = "AGE6064_MALE",
         "Female Population Aged 60-64" = "AGE6064_FEM",
         "Total Population Aged 65-69" = "AGE6569_TOT",
         "Male Population Aged 65-69" = "AGE6569_MALE",
         "Female Population Aged 65-69" = "AGE6569_FEM",
         "Total Population Aged 70-74" = "AGE7074_TOT",
         "Male Population Aged 70-74" = "AGE7074_MALE",
         "Female Population Aged 70-74" = "AGE7074_FEM",
         "Total Population Aged 75-79" = "AGE7579_TOT",
         "Male Population Aged 75-79" = "AGE7579_MALE",
         "Female Population Aged 75-79" = "AGE7579_FEM",
         "Total Population Aged 80-84" = "AGE8084_TOT",
         "Male Population Aged 80-84" = "AGE8084_MALE",
         "Female Population Aged 80-84" = "AGE8084_FEM",
         "Total Population Aged 85+" = "AGE85PLUS_TOT",
         "Male Population Aged 85+" = "AGE85PLUS_MALE",
         "Female Population Aged 85+" = "AGE85PLUS_FEM",
         "Total Median Age" = "MEDIAN_AGE_TOT",
         "Median Male Age" = "MEDIAN_AGE_MALE",
         "Median Female Age" = "MEDIAN_AGE_FEM")

#NOW THAT EVERYTHING IS RENAMED, TIME TO DOWNLOAD IT INTO MY LOCAL DISC

library(writexl)

va_demographics <- Virginia_Pop_and_Age_2020_to_2023
va_demographics

write_xlsx(va_demographics, "va_demographics.xlsx")
getwd()
